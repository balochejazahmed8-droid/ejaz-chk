name: RDP Setup
on: workflow_dispatch

jobs:
  setup:
    runs-on: windows-latest
    timeout-minutes: 120
    
    steps:
    - name: Setup RDP
      shell: powershell
      run: |
        # Enable RDP
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
        
        # Allow RDP in firewall
        netsh advfirewall firewall add rule name="Open RDP" dir=in action=allow protocol=TCP localport=3389
        
        # Create user
        $user = "admin"
        $pass = "Password123"
        net user $user $pass /add
        net localgroup administrators $user /add
        
        echo "RDP Enabled: Connect with $user:$pass"
        
    - name: Keep Alive
      shell: powershell
      run: |
        echo "Session active for 2 hours"
        Start-Sleep -Seconds 7200name: RDP Setup
on: workflow_dispatch

jobs:
  setup:
    runs-on: windows-latest
    timeout-minutes: 120
    
    steps:
    - name: Setup RDP
      shell: powershell
      run: |
        # Enable RDP
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
        
        # Allow RDP in firewall
        netsh advfirewall firewall add rule name="Open RDP" dir=in action=allow protocol=TCP localport=3389
        
        # Create user
        $user = "admin"
        $pass = "Password123"
        net user $user $pass /add
        net localgroup administrators $user /add
        
        echo "RDP Enabled: Connect with $user:$pass"
        
    - name: Keep Alive
      shell: powershell
      run: |
        echo "Session active for 2 hours"
        Start-Sleep -Seconds 7200name: RDP Setup
on: workflow_dispatch

jobs:
  setup:
    runs-on: windows-latest
    timeout-minutes: 120
    
    steps:
    - name: Setup RDP
      shell: powershell
      run: |
        # Enable RDP
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
        reg add "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f
        
        # Allow RDP in firewall
        netsh advfirewall firewall add rule name="Open RDP" dir=in action=allow protocol=TCP localport=3389
        
        # Create user
        $user = "admin"
        $pass = "Password123"
        net user $user $pass /add
        net localgroup administrators $user /add
        
        echo "RDP Enabled: Connect with $user:$pass"
        
    - name: Keep Alive
      shell: powershell
      run: |
        echo "Session active for 2 hours"
        Start-Sleep -Seconds 7200v
